# -*- coding: utf-8 -*-
"""Loan_Prediction.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1wIdGVlx11KCS6uTH8GpcsWOFxaHF92Ec

# **Project Title**

## **Loan Approval Prediction**

# Domain
Finance / Banking

# Objective

1. To analyze the loan application dataset and identify important patterns and trends that affect loan approval decisions using exploratory data analysis.

2. To perform data cleaning and preprocessing to handle missing values and prepare the dataset for effective analysis.

3. To visualize key relationships between applicant details such as income, credit history, and loan status to better understand approval outcomes.

4. To extract useful insights from the analysis that can support data-driven loan approval decisions in the banking and finance sector.

# Outcome

The project helps identify important patterns and trends in loan approval data and reveals key factors that influence approval decisions. The analysis provides a better understanding of the dataset through clear insights and visualizations, supporting data-driven and evidence-based decision-making in the loan approval process.

#**Dataset Information**

**Source:** Hugging Face -**https://huggingface.co/datasets/13nishit/LoanApprovalPrediction/raw/main/dataset.csv**

**Year / Timeline:** 2023

**Dataset Column Description:**

* **Loan_ID**- Unique identification number assigned to each loan application
* **Gender** -Gender of the applicant (Male / Female)
* **Married** -Marital status of the applicant (Yes / No)
* **Dependents**- Number of dependents the applicant has (0, 1, 2, 3+)
* **Education** -Educational qualification of the applicant (Graduate / Not Graduate)
* **Self_Employed**- Indicates whether the applicant is self-employed (Yes / No)
* **ApplicantIncome** -GMonthly income of the primary applicant
* **CoapplicantIncome**- Monthly income of the co-applicant (if any)
* **LoanAmount** -Loan amount requested by the applicant
* **Loan_Amount_Term**- Duration of the loan in months
* **Credit_History** -Credit history of the applicant (1 = good credit history, 0 = poor credit history)
* **Property_Area**- Area where the property is located (Urban / Semiurban / Rural)
* **Loan_Status** -Loan approval status (Y = Approved, N = Not Approved)

# **Note For Kind of Analysis to be done**

**Type of Analysis**

* Descriptive Analysis (summarizing the dataset)

* Diagnostic Analysis (finding reasons behind patterns)

* Predictive Analysis (optional if forecasting required using basic stats)

* Prescriptive Analysis (recommendations for business decisions)

# Stages for DA Project

## Stage 1 – Problem Definition and Dataset Selection

Define the business problem and expected outcome

Choose dataset and explain its source, size, and features

Import libraries, load dataset

Dataset description (rows, columns, features)

Initial EDA (head, info, describe, shape, null checks, duplicate check)
"""

# Loading Csv datafile in pandas
# import pandas as pd
# df = pd.read_csv("https://github.com/saranyavsaran/Loan-Approval-Prediction/blob/main/dataset.csv")
# df.head(5)
import pandas as pd

df = pd.read_csv(
    # "https://raw.githubusercontent.com/saranyavsaran/Loan-Approval-Prediction/main/dataset.csv"
    "https://raw.githubusercontent.com/saranyavsaran/Loan-Approval-Prediction/refs/heads/main/loan_data_updatedd.csv"
)

df.head(5)

df.tail()

df.info()

df.describe()

df.shape

df.isnull().sum()

df.duplicated().sum()

"""## Stage 2 – Data Cleaning and Pre-processing

Handle missing values (impute or drop)

Handle duplicates

Treat outliers if required

Check skewness and apply transformations

Convert data types if needed

Feature transformations (date parts, derived fields if required for analysis)
"""

df["Gender"].isnull().sum()
df["Gender"].mode()
df["Gender"].fillna(df["Gender"].mode()[0],inplace=True)
df['Married'].fillna(df['Married'].mode()[0], inplace=True)
df['Dependents'].fillna(df['Dependents'].mode()[0], inplace=True)
df['Self_Employed'].fillna(df['Self_Employed'].mode()[0], inplace=True)
df['LoanAmount'].fillna(df['LoanAmount'].median(), inplace=True)
df['Loan_Amount_Term'].fillna(df['Loan_Amount_Term'].median(), inplace=True)
df['Credit_History'].fillna(df['Credit_History'].median(), inplace=True)

# Duplicates Handling
df.duplicated().sum()
df = df.drop_duplicates(subset='Loan_ID')

# Treat Outliers
from pyspark.sql import SparkSession

spark = SparkSession.builder.getOrCreate()
spark_df = spark.createDataFrame(df)

q1, q3 = spark_df.approxQuantile("LoanAmount", [0.25, 0.75], 0.01)
iqr = q3 - q1

lb = q1 - 1.5 * iqr
ub = q3 + 1.5 * iqr
from pyspark.sql.functions import col, when

loan_df = spark_df.withColumn(
    "LoanAmount",
    when(col("LoanAmount") < lb, lb)
    .when(col("LoanAmount") > ub, ub)
    .otherwise(col("LoanAmount"))
)
spark_df.show()

df_clean = df.copy()
df_clean.info()
df_clean.head()

num_cols = ['ApplicantIncome', 'CoapplicantIncome', 'LoanAmount']

df[num_cols].skew()

# Log Transform
import numpy as np
df_clean['LoanAmount_log'] = np.log1p(df_clean['LoanAmount'])
df_clean['ApplicantIncome_log'] = np.log1p(df_clean['ApplicantIncome'])
df_clean['TotalIncome'] = df_clean['ApplicantIncome'] + df_clean['CoapplicantIncome']
df_clean['TotalIncome_log'] = np.log1p(df_clean['TotalIncome'])
df_clean

# Square-root transform
df_clean['LoanAmount_sqrt'] = np.sqrt(df_clean['LoanAmount'])

# Check Skewness
df_clean[['LoanAmount_log', 'ApplicantIncome_log', 'TotalIncome_log']].skew()

# Changing Datatypes
cat_cols = ['Gender', 'Married', 'Education', 'Self_Employed', 'Loan_Status', 'Dependents']

for col in cat_cols:
    df_clean[col] = df_clean[col].astype('category')

# df_clean['Gender'] = df_clean['Gender'].map({'Male':1, 'Female':0})
df_clean['Married'] = df_clean['Married'].map({'Yes':1, 'No':0})
df_clean['Self_Employed'] = df_clean['Self_Employed'].map({'Yes':1, 'No':0})
df_clean['Loan_Status'] = df_clean['Loan_Status'].map({'Y':1, 'N':0})

# Checking datatypes
df_clean.dtypes
df_clean.head()

# Derived Features – Combine Columns
df_clean['TotalIncome'] = df_clean['ApplicantIncome'] + df_clean['CoapplicantIncome']
df_clean['EMI'] = df_clean['LoanAmount'] / df_clean['Loan_Amount_Term']
df_clean['Loan_Income_Ratio'] = df_clean['EMI'] / df_clean['TotalIncome']

"""## Stage 3 – EDA and Visualizations

Univariate Analysis → distribution of single variables (countplot, histogram, boxplot)

Bivariate Analysis → relation between two variables (scatterplot, barplot, correlation heatmap)

Multivariate Analysis → relation among 3+ variables (pairplot, grouped analysis, pivot tables, advanced plots)

Interpretation MUST with every visualization

Focus on business story not just charts

Each chart must be in seperate cells.

### **Chart 1- Loan Status – Countplot**
"""

import seaborn as sns
import matplotlib.pyplot as plt
# print(df_clean)
sns.countplot(
    x='Loan_Status',
    data=df_clean,
   hue='Loan_Status')
plt.title("Loan Approval Distribution")
plt.show()

"""## Interpretation of your above chart1

**Explain the Chart.**

    CountPlot
    Descriptive: How many loans are approved vs rejected?



**What is it saying?**

    Number of approved vs rejected loans.


**What features you used?**

    Descriptive (Univariate) Analysis
**From this what you are showing us?**

    Approved loans are higher than rejected → positive approval trend
    Indicates class imbalance

### **Chart 2- Education – Countplot**
"""

sns.countplot(x='Education', data=df_clean,hue='Education')

plt.title("Education Distribution of Applicants")
plt.show()

"""## Interpretation of your above chart2

Explain the Chart.

    Education level of applicants
What is it saying?

    Graduate vs Non-Graduate applicants
What features you used?

    Descriptive (Univariate) Analysis
From this what you are showing us?

    Majority applicants are Graduates
    Indicates educated population seeks loans more frequently.

## **Chart -3 Applicant Income – Histogram**
"""

sns.histplot(df_clean['ApplicantIncome'], bins=30, kde=True)
plt.title("Applicant Income Distribution")
plt.show()

"""## Interpretation of your above chart - 3

Explain the Chart.

    Discriptive - Income distribution of applicants

What is it saying?
    
    incomes are not evenly distributed


What features you used?

    Descriptive (Univariate) Analysis



From this what you are showing us?

    The applicant income distribution is right-skewed, indicating that most loan applicants fall into the low to medium income range, while only a small fraction belong to the high-income segment.

### **Chart - 4 -Loan Amount – Boxplot**
"""

sns.boxplot(y=df_clean['LoanAmount'])
plt.title("Loan Amount Outliers")
plt.show()

"""## Interpretation of your above chart -4

Explain the Chart.

    Presence of extreme loan values

What is it saying?

    Most applicants request moderate loan amounts
    A small number of applicants request very large loans
    These extreme values are not representative of the majority.

What features you used?

    Descriptive (Univariate) Analysis

From this what you are showing us?

    The loan amount distribution contains significant outliers, indicating that a few applicants request exceptionally high loan amounts compared to the typical customer

# Chart - 5 Applicant Income vs Loan Amount (Scatterplot)
"""

sns.scatterplot(
    x='ApplicantIncome',
    y='LoanAmount',
    data=df_clean, hue = "ApplicantIncome"
)
plt.title("Applicant Income vs Loan Amount")
plt.show()

"""## Interpretation of your above chart- 5  (Diagnostic Analysis)

Explain the Chart.

    This scatter plot shows the relationship between applicant income and the loan amount requested.

What is it saying?

    There is a positive relationship where higher income applicants tend to request higher loan amounts.

What features you used?

    ApplicantIncome, LoanAmount,

From this what you are showing us?

    dependency between income and loan amount, useful for risk analysis.

## **Chart - 6 Loan Status by Education (Barplot/Countplot)**
"""

sns.countplot(
    x='Education',
    hue='Loan_Status',
    data=df_clean
)
plt.title("Loan Status by Education")
plt.show()

"""## Interpretation of your above chart- 6  (Diagnostic Analysis)

Explain the Chart.

    This bar plot compares loan approval status across education levels.

What is it saying?

    Graduates have a higher loan approval rate compared to non-graduates.

What features you used?

    Education,Loan_Status

From this what you are showing us?

    We are showing how education level impacts loan approval decisions.

## Chart - 7  Correlation Heatmap
"""

plt.figure(figsize=(8,6))

numeric_df = df_clean.select_dtypes(include=['int64', 'float64'])
sns.heatmap(numeric_df.corr(), annot=True, cmap='coolwarm')

plt.title("Correlation Heatmap")
plt.show()

"""## Interpretation of your above chart- 7  (Diagnostic Analysis)

Explain the Chart.

    This heatmap visualizes correlation values between numerical features.

What is it saying?

    Applicant income and loan amount show a positive correlation, while some features have weak or no correlation.

What features you used?

    Numerical features (ApplicantIncome, LoanAmount, etc.)

From this what you are showing us?

    We are identifying important features and reducing redundancy before modeling.

## **Chart -8  Pairplot – Income, Loan & Approval Status**
"""

sns.pairplot(
    df_clean,
    vars=['ApplicantIncome', 'CoapplicantIncome', 'LoanAmount'],
    hue='Loan_Status',
    diag_kind='kde'
)
plt.show()

"""## Interpretation of your above chart-8

Explain the Chart.

    Pairplot shows pairwise relationships among multiple numerical variables, colored by loan approval status.

What is it saying?

    Approved loans cluster around moderate to high income
    Rejected loans appear more in low-income ranges
    LoanAmount increases with combined income

From this what you are showing us?

    Income-related features strongly influence approval. Combined income is a key approval driver

## **Chart - 9  Multivariate Heatmap – Grouped Correlation**
"""

grouped = df_clean.groupby('Loan_Status')[['ApplicantIncome', 'LoanAmount']]
grouped.mean().plot(kind='bar')
plt.title("Average Income & Loan Amount by Loan Status")
plt.show()

"""## Interpretation of your above chart-9
Explain the Chart.

    This chart compares average income and loan amount across loan approval outcomes.

What is it saying?

    Approved applicants have higher average income. Loan amounts are also higher for approved cases

From this what you are showing us?

    Confirms income is a key approval factor. Supports income-based eligibility rules

## **Chart - 10 Advanced Multivariate Plot – Violin Plot**
"""

sns.violinplot(
    x='Loan_Status',
    y='LoanAmount',
    hue='Education',
    data=df_clean,
    split=True
)
plt.title("Loan Amount Distribution by Approval & Education")
plt.show()

"""## Interpretation of your above chart-10
Explain the Chart.

    Violin plot shows loan amount distribution by approval status and education level.

What is it saying?

    Graduates show wider loan amount range. Approved graduates receive higher loan amounts

From this what you are showing us?

    Education influences loan amount and approval probability. Can be used for customer segmentation

"""

# Prescriptive Analysis (What should we do?)
def loan_decision(income, loan_amount):
    if income > 5000 and loan_amount < 200:
        return "Approve loan with standard interest"
    elif income > 5000 and loan_amount >= 200:
        return "Approve with additional verification"
    else:
        return "High risk – manual review required"

loan_decision(6000, 250)

"""### **Business Insight:**


*   Enables actionable recommendations

*   Helps control financial risk
    
*   Supports policy-based loan approval strategies

## Stage 4 – Documentation, Insights and Presentation

# **Descriptive Analysis**
(What does the data look like?)

**Description**

Descriptive analysis was performed to summarize and understand the overall structure of the dataset. Univariate analysis techniques were used to study individual variables such as loan status, applicant demographics, income, and loan amount.

**Techniques Used**

Countplots for categorical variables (Loan_Status, Gender, Education)

Histograms for numerical variables (ApplicantIncome, LoanAmount)

Boxplots to identify outliers in LoanAmount

**Key Findings**
Loan approvals are higher than rejections, indicating a slight class imbalance.

Most applicants request small to medium loan amounts.

Income and loan amount distributions are right-skewed, with a few applicants requesting very high loans.

**Conclusion**

Descriptive analysis provided a clear baseline understanding of applicant profiles and loan demand patterns, helping identify skewness, imbalance, and outliers in the data.

# **Diagnostic Analysis**

(Why did it happen?)

**Description**

Diagnostic analysis explored relationships between variables to understand the factors influencing loan approval and rejection decisions.

**Techniques Used**

Bar plots (Education vs Loan_Status, Gender vs Loan_Status)

Scatter plots (Income vs LoanAmount)

Correlation heatmap for numerical features

**Key Findings**

Credit history shows a strong relationship with loan approval.

Applicants with low income and high loan demand are more likely to be rejected.

Education level positively impacts approval probability, while gender has minimal influence.

**Conclusion**

Diagnostic analysis identified credit history, income level, and loan amount as key drivers of loan approval decisions.

# **Predictive Analysis**

(What is likely to happen?)

**Description**

Predictive analysis focused on building machine learning models to predict whether a loan application will be approved based on applicant features.

**Techniques Used**

Feature engineering and encoding

Machine learning models (e.g., Logistic Regression, Decision Tree, Random Forest)

Model evaluation using accuracy, precision, recall, and ROC-AUC

**Key Findings**

Models can effectively predict loan approval using financial and demographic features.

Credit history, income, and loan amount are the most influential predictors.

**Conclusion**

Predictive models successfully estimate loan approval likelihood, enabling proactive risk assessment for new applicants.

# **Prescriptive Analysis**

(What should be done?)

**Description**


Prescriptive analysis translates insights from descriptive, diagnostic, and predictive analysis into actionable business recommendations.

**Recommendations**

Prioritize loan approvals for applicants with strong credit history and stable income.

Re-evaluate or offer lower loan amounts to applicants with high loan-to-income ratios.

Use predictive model scores to automate and standardize loan approval decisions.

**Conclusion**

Prescriptive analysis provides actionable strategies that help banks minimize risk while improving approval efficiency and decision consistency.
"""

df_clean.to_csv('loan_data_updated.csv', index=False)
from google.colab import files
files.download('loan_data_updated.csv')

"""## **Dashboard Section**"""

PDF LINK  :   https://drive.google.com/file/d/1kNmZqPeysMnyP4aCVVBxuBwnOHo4lNtp/view?usp=drive_link

"""# Future Enhancement
Add more applicant details like credit history and employment type for better analysis.

Use predictive models to estimate loan approval chances.

Improve the dashboard with more filters and drill-down options.

Enable automatic data refresh for up-to-date insights.

# Conclusion

In this project, I applied descriptive, diagnostic, predictive, and prescriptive analysis to study the loan approval process.
Descriptive and diagnostic analysis helped identify key patterns and drivers such as credit history, income, and loan amount.
Predictive models were used to estimate loan approval outcomes accurately.
Finally, prescriptive insights provided actionable recommendations to improve risk-aware loan approval decisions.
"""